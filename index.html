<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Potato Embed Generator</title>
  <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7.22.5/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/framer-motion@10.16.4/dist/framer-motion.js"></script>
  <script src="https://unpkg.com/react-tooltip@5.26.3/dist/react-tooltip.min.js"></script>
  <!-- Note: Using cdn.tailwindcss.com for prototyping. For production, install Tailwind CSS via PostCSS or CLI: https://tailwindcss.com/docs/installation -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #0a1126 0%, #16213e 100%);
      min-height: 100vh;
      color: #e0e7ff;
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
    }
    .glass {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
    }
    .glow {
      box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
    }
    .neon-border {
      border: 2px solid #3b82f6;
      box-shadow: 0 0 12px #3b82f6;
    }
    .input-focus {
      transition: all 0.3s ease;
    }
    .input-focus:focus {
      outline: none;
      box-shadow: 0 0 20px #3b82f6;
      border-color: #60a5fa;
      transform: scale(1.02);
    }
    .sidebar {
      transition: transform 0.3s ease;
    }
    .sidebar-hidden {
      transform: translateX(-100%);
    }
    .fade-in {
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .pulse {
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
      100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
    }
    .spin {
      animation: spin 1.5s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .tooltip {
      background: #1f2937;
      color: #e0e7ff;
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 12px;
    }
    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        z-index: 50;
      }
      .main-content {
        margin-left: 0 !important;
      }
      .preview-pane {
        max-height: 400px;
        overflow-y: auto;
      }
    }
    .error-message {
      color: #ff4444;
      text-align: center;
      padding: 20px;
    }
    .embed-preview {
      background: #2f3136;
      border-radius: 8px;
      padding: 16px;
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.3);
    }
    .embed-preview img {
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <!-- Note: Using in-browser Babel transformer for prototyping. For production, precompile scripts: https://babeljs.io/docs/setup/ -->
  <script type="text/babel">
    try {
      const { useState, useEffect } = React;
      // Fallback for Framer Motion
      const MotionComponent = window.FramerMotion && window.FramerMotion.motion ? window.FramerMotion.motion.div : 'div';
      const MotionButton = window.FramerMotion && window.FramerMotion.motion ? window.FramerMotion.motion.button : 'button';
      const hasMotion = !!window.FramerMotion;
      // Fallback for React Tooltip
      const Tooltip = window.ReactTooltip && window.ReactTooltip.Tooltip ? window.ReactTooltip.Tooltip : () => null;

      const testEmbedTemplate = {
        title: 'Welcome to Potato Embed Generator!',
        description: 'Craft stunning Discord embeds with AI-powered tools and real-time previews. Start creating now!',
        color: '#3b82f6',
        author: 'Potato Team',
        footer: 'Powered by GroqCloud AI',
        image: 'https://picsum.photos/600/200?random=1',
        thumbnail: 'https://picsum.photos/100/100?random=2',
        fields: [
          { name: 'Feature 1', value: 'AI-driven embed creation', inline: true },
          { name: 'Feature 2', value: 'Seamless mobile experience', inline: true }
        ],
        timestamp: true
      };

      const PotatoEmbedGenerator = () => {
        const [embeds, setEmbeds] = useState([testEmbedTemplate]);
        const [activeEmbedIndex, setActiveEmbedIndex] = useState(0);
        const [webhook, setWebhook] = useState('');
        const [sidebarOpen, setSidebarOpen] = useState(window.innerWidth > 768);
        const [jsonModalOpen, setJsonModalOpen] = useState(false);
        const [jsonInput, setJsonInput] = useState('');
        const [activeTab, setActiveTab] = useState('builder');
        const [aiPrompt, setAiPrompt] = useState('');
        const [aiLoading, setAiLoading] = useState(false);

        useEffect(() => {
          const handleResize = () => setSidebarOpen(window.innerWidth > 768);
          window.addEventListener('resize', handleResize);
          return () => window.removeEventListener('resize', handleResize);
        }, []);

        const addEmbed = () => {
          setEmbeds([...embeds, {
            title: '',
            description: '',
            color: '#3b82f6',
            author: '',
            footer: '',
            image: '',
            thumbnail: '',
            fields: [],
            timestamp: false
          }]);
          setActiveEmbedIndex(embeds.length);
        };

        const removeEmbed = (index) => {
          if (embeds.length === 1) return;
          setEmbeds(embeds.filter((_, i) => i !== index));
          if (activeEmbedIndex >= index && activeEmbedIndex > 0) {
            setActiveEmbedIndex(activeEmbedIndex - 1);
          }
        };

        const updateEmbed = (field, value) => {
          const newEmbeds = [...embeds];
          newEmbeds[activeEmbedIndex] = { ...newEmbeds[activeEmbedIndex], [field]: value };
          setEmbeds(newEmbeds);
        };

        const addField = () => {
          const newEmbeds = [...embeds];
          newEmbeds[activeEmbedIndex].fields.push({ name: '', value: '', inline: false });
          setEmbeds(newEmbeds);
        };

        const updateField = (index, field, value) => {
          const newEmbeds = [...embeds];
          newEmbeds[activeEmbedIndex].fields[index] = {
            ...newEmbeds[activeEmbedIndex].fields[index],
            [field]: value
          };
          setEmbeds(newEmbeds);
        };

        const removeField = (index) => {
          const newEmbeds = [...embeds];
          newEmbeds[activeEmbedIndex].fields = newEmbeds[activeEmbedIndex].fields.filter((_, i) => i !== index);
          setEmbeds(newEmbeds);
        };

        const toggleTimestamp = () => {
          const newEmbeds = [...embeds];
          newEmbeds[activeEmbedIndex].timestamp = !newEmbeds[activeEmbedIndex].timestamp;
          setEmbeds(newEmbeds);
        };

        const exportJson = () => {
          try {
            const json = JSON.stringify({ embeds }, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'potato-embed.json';
            a.click();
            URL.revokeObjectURL(url);
          } catch (error) {
            console.error('Export JSON error:', error);
            alert('Failed to export JSON');
          }
        };

        const importJson = () => {
          try {
            const parsed = JSON.parse(jsonInput);
            if (parsed.embeds && Array.isArray(parsed.embeds)) {
              setEmbeds(parsed.embeds);
              setActiveEmbedIndex(0);
              setJsonModalOpen(false);
              setJsonInput('');
            } else {
              alert('Invalid JSON format');
            }
          } catch (error) {
            console.error('Import JSON error:', error);
            alert('Error parsing JSON: ' + error.message);
          }
        };

        const sendWebhook = async () => {
          if (!webhook) {
            alert('Please enter a webhook URL');
            return;
          }
          try {
            const response = await fetch(webhook, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                embeds: embeds.map(embed => ({
                  title: embed.title,
                  description: embed.description,
                  color: parseInt(embed.color.replace('#', ''), 16),
                  author: { name: embed.author },
                  footer: { text: embed.footer },
                  image: { url: embed.image },
                  thumbnail: { url: embed.thumbnail },
                  fields: embed.fields,
                  timestamp: embed.timestamp ? new Date().toISOString() : undefined
                }))
              })
            });
            if (response.ok) {
              alert('Embeds sent successfully!');
            } else {
              alert('Failed to send embeds.');
            }
          } catch (error) {
            console.error('Webhook error:', error);
            alert('Error sending embeds: ' + error.message);
          }
        };

        const generateAIEmbed = async (retry = false) => {
          if (!aiPrompt) {
            alert('Please enter an AI prompt');
            return;
          }
          setAiLoading(true);
          let content = '';
          try {
            const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer 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'
              },
              body: JSON.stringify({
                model: 'llama3-8b-8192',
                messages: [
                  {
                    role: 'system',
                    content: 'You are a JSON generator for Discord embeds. Respond only with a valid JSON object wrapped in ```json\n...\n```. Do not include any text, explanations, or comments outside the JSON block. Ensure the JSON is complete, properly formatted, and contains no syntax errors.'
                  },
                  {
                    role: 'user',
                    content: retry
                      ? `The previous response was invalid. Generate a valid Discord embed JSON object based on this prompt: "${aiPrompt}". The JSON must include: title (string), description (string), color (hex string), author (object with name), footer (object with text), fields (array of 2 objects with name, value, inline properties). Return only the JSON object in \`\`\`json\n...\n\`\`\`. Example:
\`\`\`json
{
  "title": "Example Embed",
  "description": "This is an example",
  "color": "#3b82f6",
  "author": { "name": "Example Author" },
  "footer": { "text": "Example Footer" },
  "fields": [
    { "name": "Field 1", "value": "Value 1", "inline": true },
    { "name": "Field 2", "value": "Value 2", "inline": true }
  ]
}
\`\`\`
`
                      : `Generate a Discord embed JSON object based on this prompt: "${aiPrompt}". The JSON must include: title (string), description (string), color (hex string), author (object with name), footer (object with text), fields (array of 2 objects with name, value, inline properties). Return only the JSON object in \`\`\`json\n...\n\`\`\`. Example:
\`\`\`json
{
  "title": "Example Embed",
  "description": "This is an example",
  "color": "#3b82f6",
  "author": { "name": "Example Author" },
  "footer": { "text": "Example Footer" },
  "fields": [
    { "name": "Field 1", "value": "Value 1", "inline": true },
    { "name": "Field 2", "value": "Value 2", "inline": true }
  ]
}
\`\`\`
`
                  }
                ],
                max_tokens: 500
              })
            });
            const data = await response.json();
            console.log('Raw AI response:', data);
            if (data.choices && data.choices[0].message.content) {
              content = data.choices[0].message.content;
              console.log('Response content:', content);
              let jsonMatch = content.match(/```json\n([\s\S]*?)\n```/);
              let jsonString;
              if (jsonMatch && jsonMatch[1]) {
                jsonString = jsonMatch[1].trim();
                console.log('Extracted JSON string:', jsonString);
              } else {
                jsonString = content.trim();
                console.log('Fallback JSON string:', jsonString);
                if (jsonString.startsWith('```json')) {
                  jsonString = jsonString.replace(/^```json\n?/, '').replace(/\n?```$/, '').trim();
                }
                if (!jsonString.startsWith('{') && !jsonString.startsWith('[')) {
                  if (!retry) {
                    console.log('Retrying with stricter prompt');
                    return await generateAIEmbed(true);
                  }
                  throw new Error('Response is not JSON');
                }
              }
              try {
                const aiEmbed = JSON.parse(jsonString);
                if (!aiEmbed.title || !aiEmbed.description || !aiEmbed.color || !aiEmbed.author || !aiEmbed.footer || !Array.isArray(aiEmbed.fields)) {
                  throw new Error('Invalid JSON structure: Missing required fields');
                }
                const newEmbeds = [...embeds];
                newEmbeds[activeEmbedIndex] = {
                  title: aiEmbed.title || '',
                  description: aiEmbed.description || '',
                  color: aiEmbed.color || '#3b82f6',
                  author: aiEmbed.author?.name || '',
                  footer: aiEmbed.footer?.text || '',
                  image: '',
                  thumbnail: '',
                  fields: aiEmbed.fields || [],
                  timestamp: false
                };
                setEmbeds(newEmbeds);
                setAiPrompt('');
              } catch (parseError) {
                console.error('JSON parse error:', parseError);
                if (!retry) {
                  console.log('Retrying with stricter prompt');
                  return await generateAIEmbed(true);
                }
                throw new Error(`Failed to parse JSON: ${parseError.message}`);
              }
            } else {
              throw new Error('Invalid AI response: No content received');
            }
          } catch (error) {
            console.error('AI Embed error:', error);
            console.log('Attempted JSON string:', content || 'No content available');
            alert(`Error generating AI embed: ${error.message}. Please try a different prompt or check the console for details.`);
          } finally {
            setAiLoading(false);
          }
        };

        return (
          <MotionComponent
            className="min-h-screen"
            {...(hasMotion ? { initial: { opacity: 0 }, animate: { opacity: 1 }, transition: { duration: 0.5 } } : {})}
          >
            {/* Sidebar */}
            <MotionComponent
              className={`fixed top-0 left-0 h-full w-72 bg-gray-900 p-6 sidebar glass ${sidebarOpen ? '' : 'sidebar-hidden'} md:w-80 z-50`}
              {...(hasMotion ? { animate: { x: sidebarOpen ? 0 : '-100%' }, transition: { type: 'spring', stiffness: 300, damping: 30 } } : {})}
            >
              <h2 className="text-3xl font-bold mb-8 flex items-center gap-3 text-blue-400">
                <i className="fas fa-tachometer-alt"></i> Dashboard
              </h2>
              <div className="space-y-4">
                <MotionButton
                  onClick={addEmbed}
                  className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl flex items-center justify-center gap-2 pulse"
                  {...(hasMotion ? { whileHover: { scale: 1.05 }, whileTap: { scale: 0.95 } } : {})}
                  data-tooltip-id="tooltip-add-embed"
                  data-tooltip-content="Create a new embed"
                >
                  <i className="fas fa-plus"></i> Add Embed
                </MotionButton>
                <div>
                  <h3 className="text-lg font-semibold mb-3 text-gray-200">Your Embeds</h3>
                  {embeds.map((embed, index) => (
                    <MotionComponent
                      key={index}
                      className="flex items-center gap-2 mb-3"
                      {...(hasMotion ? { initial: { opacity: 0, y: 10 }, animate: { opacity: 1, y: 0 }, transition: { delay: index * 0.1 } } : {})}
                    >
                      <MotionButton
                        onClick={() => setActiveEmbedIndex(index)}
                        className={`flex-1 text-left px-4 py-2 rounded-xl ${index === activeEmbedIndex ? 'bg-blue-600' : 'bg-gray-800'} hover:bg-blue-700 transition-all`}
                        {...(hasMotion ? { whileHover: { scale: 1.02 } } : {})}
                        data-tooltip-id={`tooltip-embed-${index}`}
                        data-tooltip-content={`Edit Embed ${index + 1}`}
                      >
                        Embed {index + 1}
                      </MotionButton>
                      <MotionButton
                        onClick={() => removeEmbed(index)}
                        className="text-red-400 hover:text-red-600"
                        disabled={embeds.length === 1}
                        {...(hasMotion ? { whileHover: { scale: 1.1 } } : {})}
                        data-tooltip-id={`tooltip-delete-${index}`}
                        data-tooltip-content="Delete this embed"
                      >
                        <i className="fas fa-trash"></i>
                      </MotionButton>
                    </MotionComponent>
                  ))}
                </div>
                <MotionButton
                  onClick={() => setJsonModalOpen(true)}
                  className="w-full bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl flex items-center justify-center gap-2"
                  {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                  data-tooltip-id="tooltip-import-json"
                  data-tooltip-content="Import embeds from JSON"
                >
                  <i className="fas fa-file-import"></i> Import JSON
                </MotionButton>
                <MotionButton
                  onClick={exportJson}
                  className="w-full bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl flex items-center justify-center gap-2"
                  {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                  data-tooltip-id="tooltip-export-json"
                  data-tooltip-content="Export embeds as JSON"
                >
                  <i className="fas fa-file-export"></i> Export JSON
                </MotionButton>
              </div>
            </MotionComponent>
            {/* Main Content */}
            <MotionComponent
              className={`transition-all duration-300 main-content ${sidebarOpen ? 'md:ml-80 ml-0' : 'ml-0'} p-6 md:p-8`}
              {...(hasMotion ? { animate: { marginLeft: sidebarOpen && window.innerWidth > 768 ? '20rem' : '0' } } : {})}
            >
              <header className="flex flex-col md:flex-row items-center justify-between mb-10">
                <MotionComponent
                  {...(hasMotion ? { initial: { opacity: 0, x: -20 }, animate: { opacity: 1, x: 0 }, transition: { duration: 0.5 } } : {})}
                >
                  <h1 className="text-5xl md:text-6xl font-bold text-white flex items-center gap-4">
                    <i className="fas fa-microchip text-blue-400"></i> Potato Embed Generator
                  </h1>
                  <p className="text-gray-300 mt-3 text-lg">Design breathtaking Discord embeds with AI and real-time previews</p>
                </MotionComponent>
                <MotionButton
                  onClick={() => setSidebarOpen(!sidebarOpen)}
                  className="text-3xl text-gray-300 hover:text-white mt-4 md:mt-0"
                  {...(hasMotion ? { whileHover: { scale: 1.2 } } : {})}
                  data-tooltip-id="tooltip-toggle-sidebar"
                  data-tooltip-content={sidebarOpen ? 'Hide Sidebar' : 'Show Sidebar'}
                >
                  <i className={`fas ${sidebarOpen ? 'fa-chevron-left' : 'fa-chevron-right'}`}></i>
                </MotionButton>
              </header>
              {/* Tabs */}
              <MotionComponent
                className="flex border-b border-gray-700 mb-8"
                {...(hasMotion ? { initial: { y: 20, opacity: 0 }, animate: { y: 0, opacity: 1 }, transition: { duration: 0.5 } } : {})}
              >
                <MotionButton
                  onClick={() => setActiveTab('builder')}
                  className={`flex-1 py-4 px-6 text-center text-lg font-medium ${activeTab === 'builder' ? 'bg-blue-600 text-white' : 'bg-gray-800 text-gray-300'} hover:bg-blue-700 transition-all rounded-t-xl`}
                  {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                  data-tooltip-id="tooltip-builder-tab"
                  data-tooltip-content="Manually edit your embed"
                >
                  <i className="fas fa-edit mr-2"></i> Embed Builder
                </MotionButton>
                <MotionButton
                  onClick={() => setActiveTab('ai')}
                  className={`flex-1 py-4 px-6 text-center text-lg font-medium ${activeTab === 'ai' ? 'bg-blue-600 text-white' : 'bg-gray-800 text-gray-300'} hover:bg-blue-700 transition-all rounded-t-xl`}
                  {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                  data-tooltip-id="tooltip-ai-tab"
                  data-tooltip-content="Generate embeds with AI"
                >
                  <i className="fas fa-robot mr-2"></i> AI Assistant
                </MotionButton>
              </MotionComponent>
              <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                {/* Content Area */}
                <MotionComponent
                  className="glass rounded-2xl p-8 glow fade-in"
                  {...(hasMotion ? { initial: { opacity: 0, scale: 0.95 }, animate: { opacity: 1, scale: 1 }, transition: { duration: 0.5 } } : {})}
                >
                  {activeTab === 'builder' ? (
                    <>
                      <h2 className="text-3xl font-semibold mb-8 flex items-center gap-3 text-white">
                        <i className="fas fa-edit text-blue-400"></i> Embed Builder
                      </h2>
                      <div className="space-y-6">
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Title</label>
                          <input
                            type="text"
                            value={embeds[activeEmbedIndex].title}
                            onChange={(e) => updateEmbed('title', e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            placeholder="Enter embed title"
                            aria-label="Embed title"
                            data-tooltip-id="tooltip-title"
                            data-tooltip-content="Set the embed's main title"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Description</label>
                          <textarea
                            value={embeds[activeEmbedIndex].description}
                            onChange={(e) => updateEmbed('description', e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            rows="4"
                            placeholder="Enter embed description"
                            aria-label="Embed description"
                            data-tooltip-id="tooltip-description"
                            data-tooltip-content="Add a detailed description"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Color</label>
                          <input
                            type="color"
                            value={embeds[activeEmbedIndex].color}
                            onChange={(e) => updateEmbed('color', e.target.value)}
                            className="w-full h-12 bg-gray-800 rounded-xl input-focus neon-border cursor-pointer"
                            aria-label="Embed color"
                            data-tooltip-id="tooltip-color"
                            data-tooltip-content="Choose the embed's border color"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Author</label>
                          <input
                            type="text"
                            value={embeds[activeEmbedIndex].author}
                            onChange={(e) => updateEmbed('author', e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            placeholder="Enter author name"
                            aria-label="Embed author"
                            data-tooltip-id="tooltip-author"
                            data-tooltip-content="Set the embed's author name"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Footer</label>
                          <input
                            type="text"
                            value={embeds[activeEmbedIndex].footer}
                            onChange={(e) => updateEmbed('footer', e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            placeholder="Enter footer text"
                            aria-label="Embed footer"
                            data-tooltip-id="tooltip-footer"
                            data-tooltip-content="Add a footer message"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Image URL</label>
                          <input
                            type="text"
                            value={embeds[activeEmbedIndex].image}
                            onChange={(e) => updateEmbed('image', e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            placeholder="Enter image URL (e.g., https://example.com/image.jpg)"
                            aria-label="Embed image URL"
                            data-tooltip-id="tooltip-image"
                            data-tooltip-content="Add a main image to the embed"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Thumbnail URL</label>
                          <input
                            type="text"
                            value={embeds[activeEmbedIndex].thumbnail}
                            onChange={(e) => updateEmbed('thumbnail', e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            placeholder="Enter thumbnail URL (e.g., https://example.com/thumb.jpg)"
                            aria-label="Embed thumbnail URL"
                            data-tooltip-id="tooltip-thumbnail"
                            data-tooltip-content="Add a small thumbnail image"
                          />
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Timestamp</label>
                          <MotionButton
                            onClick={toggleTimestamp}
                            className={`w-full text-left px-4 py-3 rounded-xl ${embeds[activeEmbedIndex].timestamp ? 'bg-blue-600' : 'bg-gray-800'} hover:bg-blue-700 flex items-center gap-2`}
                            {...(hasMotion ? { whileHover: { scale: 1.02 } } : {})}
                            data-tooltip-id="tooltip-timestamp"
                            data-tooltip-content="Toggle timestamp display"
                          >
                            <i className="fas fa-clock"></i>
                            {embeds[activeEmbedIndex].timestamp ? 'Enabled' : 'Disabled'}
                          </MotionButton>
                        </div>
                        <div>
                          <h3 className="text-xl font-semibold mb-4 text-gray-200">Fields</h3>
                          {embeds[activeEmbedIndex].fields.map((field, index) => (
                            <MotionComponent
                              key={index}
                              className="glass rounded-xl p-5 mb-4"
                              {...(hasMotion ? { initial: { opacity: 0, y: 10 }, animate: { opacity: 1, y: 0 }, transition: { duration: 0.3 } } : {})}
                            >
                              <div className="flex items-center justify-between mb-3">
                                <label className="text-sm font-medium text-gray-200">Field {index + 1}</label>
                                <MotionButton
                                  onClick={() => removeField(index)}
                                  className="text-red-400 hover:text-red-600"
                                  {...(hasMotion ? { whileHover: { scale: 1.1 } } : {})}
                                  data-tooltip-id={`tooltip-remove-field-${index}`}
                                  data-tooltip-content="Remove this field"
                                >
                                  <i className="fas fa-trash"></i>
                                </MotionButton>
                              </div>
                              <input
                                type="text"
                                value={field.name}
                                onChange={(e) => updateField(index, 'name', e.target.value)}
                                className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 mb-3 input-focus neon-border"
                                placeholder="Field name"
                                aria-label={`Field ${index + 1} name`}
                                data-tooltip-id={`tooltip-field-name-${index}`}
                                data-tooltip-content="Set the field title"
                              />
                              <textarea
                                value={field.value}
                                onChange={(e) => updateField(index, 'value', e.target.value)}
                                className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 mb-3 input-focus neon-border"
                                rows="3"
                                placeholder="Field value"
                                aria-label={`Field ${index + 1} value`}
                                data-tooltip-id={`tooltip-field-value-${index}`}
                                data-tooltip-content="Set the field content"
                              />
                              <label className="flex items-center gap-2 text-gray-200">
                                <input
                                  type="checkbox"
                                  checked={field.inline}
                                  onChange={(e) => updateField(index, 'inline', e.target.checked)}
                                  className="form-checkbox text-blue-600 h-5 w-5"
                                  aria-label={`Field ${index + 1} inline`}
                                  data-tooltip-id={`tooltip-field-inline-${index}`}
                                  data-tooltip-content="Display field inline"
                                />
                                Inline
                              </label>
                            </MotionComponent>
                          ))}
                          <MotionButton
                            onClick={addField}
                            className="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl flex items-center justify-center gap-2"
                            {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                            data-tooltip-id="tooltip-add-field"
                            data-tooltip-content="Add a new field"
                          >
                            <i className="fas fa-plus"></i> Add Field
                          </MotionButton>
                        </div>
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">Webhook URL</label>
                          <input
                            type="text"
                            value={webhook}
                            onChange={(e) => setWebhook(e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            placeholder="Enter Discord webhook URL"
                            aria-label="Webhook URL"
                            data-tooltip-id="tooltip-webhook"
                            data-tooltip-content="Send embeds to a Discord webhook"
                          />
                        </div>
                        <MotionButton
                          onClick={sendWebhook}
                          className="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-xl flex items-center justify-center gap-2 pulse"
                          {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                          data-tooltip-id="tooltip-send-webhook"
                          data-tooltip-content="Send embeds to Discord"
                        >
                          <i className="fas fa-paper-plane"></i> Send Embeds
                        </MotionButton>
                      </div>
                    </>
                  ) : (
                    <>
                      <h2 className="text-3xl font-semibold mb-8 flex items-center gap-3 text-white">
                        <i className="fas fa-robot text-blue-400"></i> AI Assistant
                      </h2>
                      <div className="space-y-6">
                        <div>
                          <label className="block text-sm font-medium mb-2 text-gray-200">AI Prompt</label>
                          <textarea
                            value={aiPrompt}
                            onChange={(e) => setAiPrompt(e.target.value)}
                            className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                            rows="6"
                            placeholder="Describe your embed (e.g., 'Create an embed for a gaming event with a bold title, event details, and a blue theme')"
                            aria-label="AI prompt"
                            data-tooltip-id="tooltip-ai-prompt"
                            data-tooltip-content="Describe the embed for AI to generate"
                          />
                        </div>
                        <MotionButton
                          onClick={generateAIEmbed}
                          disabled={aiLoading}
                          className={`w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-xl flex items-center justify-center gap-2 ${aiLoading ? 'opacity-50 cursor-not-allowed' : 'pulse'}`}
                          {...(hasMotion ? { whileHover: { scale: aiLoading ? 1 : 1.05 } } : {})}
                          data-tooltip-id="tooltip-generate-ai"
                          data-tooltip-content="Generate an embed with AI"
                        >
                          {aiLoading ? (
                            <>
                              <i className="fas fa-spinner spin"></i> Generating...
                            </>
                          ) : (
                            <>
                              <i className="fas fa-magic"></i> Generate Embed
                            </>
                          )}
                        </MotionButton>
                      </div>
                    </>
                  )}
                </MotionComponent>
                {/* Embed Preview */}
                <MotionComponent
                  className="glass rounded-2xl p-8 glow fade-in preview-pane"
                  {...(hasMotion ? { initial: { opacity: 0, scale: 0.95 }, animate: { opacity: 1, scale: 1 }, transition: { duration: 0.5 } } : {})}
                >
                  <h2 className="text-3xl font-semibold mb-8 flex items-center gap-3 text-white">
                    <i className="fas fa-eye text-blue-400"></i> Embed Preview
                  </h2>
                  <div
                    className="embed-preview border-l-4 p-5"
                    style={{ borderColor: embeds[activeEmbedIndex].color }}
                  >
                    {embeds[activeEmbedIndex].author && (
                      <p className="text-sm font-medium text-gray-400 mb-2">{embeds[activeEmbedIndex].author}</p>
                    )}
                    {embeds[activeEmbedIndex].title && (
                      <h3 className="text-xl font-bold text-white mb-2">{embeds[activeEmbedIndex].title}</h3>
                    )}
                    {embeds[activeEmbedIndex].description && (
                      <p className="text-gray-300 mb-4 leading-relaxed">{embeds[activeEmbedIndex].description}</p>
                    )}
                    {embeds[activeEmbedIndex].fields.length > 0 && (
                      <div className="mb-4 grid gap-4 md:grid-cols-2">
                        {embeds[activeEmbedIndex].fields.map((field, index) => (
                          <div key={index} className={field.inline ? 'md:inline-block md:mr-4' : ''}>
                            <p className="font-semibold text-gray-200">{field.name}</p>
                            <p className="text-gray-400">{field.value}</p>
                          </div>
                        ))}
                      </div>
                    )}
                    {embeds[activeEmbedIndex].image && (
                      <img
                        src={embeds[activeEmbedIndex].image}
                        alt="Embed Image"
                        className="mt-4 max-w-full"
                        onError={(e) => (e.target.style.display = 'none')}
                      />
                    )}
                    {embeds[activeEmbedIndex].thumbnail && (
                      <img
                        src={embeds[activeEmbedIndex].thumbnail}
                        alt="Embed Thumbnail"
                        className="mt-4 max-w-[100px] float-right"
                        onError={(e) => (e.target.style.display = 'none')}
                      />
                    )}
                    {(embeds[activeEmbedIndex].footer || embeds[activeEmbedIndex].timestamp) && (
                      <div className="mt-4 flex items-center gap-2 text-sm text-gray-400">
                        {embeds[activeEmbedIndex].footer && (
                          <p>{embeds[activeEmbedIndex].footer}</p>
                        )}
                        {embeds[activeEmbedIndex].timestamp && (
                          <p>â€¢ {new Date().toLocaleString()}</p>
                        )}
                      </div>
                    )}
                  </div>
                </MotionComponent>
              </div>
            </MotionComponent>
            {/* JSON Import Modal */}
            {jsonModalOpen && (
              <MotionComponent
                className="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50"
                {...(hasMotion ? { initial: { opacity: 0 }, animate: { opacity: 1 }, exit: { opacity: 0 } } : {})}
              >
                <MotionComponent
                  className="glass rounded-2xl p-8 w-full max-w-lg glow"
                  {...(hasMotion ? { initial: { scale: 0.8, opacity: 0 }, animate: { scale: 1, opacity: 1 }, transition: { type: 'spring', stiffness: 300, damping: 20 } } : {})}
                >
                  <h2 className="text-3xl font-semibold mb-6 flex items-center gap-3 text-white">
                    <i className="fas fa-file-import text-blue-400"></i> Import JSON
                  </h2>
                  <textarea
                    value={jsonInput}
                    onChange={(e) => setJsonInput(e.target.value)}
                    className="w-full bg-gray-800 text-white rounded-xl px-4 py-3 input-focus neon-border"
                    rows="6"
                    placeholder="Paste your JSON here"
                    aria-label="JSON input"
                    data-tooltip-id="tooltip-json-input"
                    data-tooltip-content="Paste a valid JSON embed structure"
                  />
                  <div className="flex gap-4 mt-6">
                    <MotionButton
                      onClick={importJson}
                      className="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-xl flex items-center justify-center gap-2"
                      {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                      data-tooltip-id="tooltip-import-button"
                      data-tooltip-content="Import the JSON data"
                    >
                      <i className="fas fa-upload"></i> Import
                    </MotionButton>
                    <MotionButton
                      onClick={() => setJsonModalOpen(false)}
                      className="flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl flex items-center justify-center gap-2"
                      {...(hasMotion ? { whileHover: { scale: 1.05 } } : {})}
                      data-tooltip-id="tooltip-cancel-button"
                      data-tooltip-content="Close the modal"
                    >
                      <i className="fas fa-times"></i> Cancel
                    </MotionButton>
                  </div>
                </MotionComponent>
              </MotionComponent>
            )}
            <Tooltip id="tooltip-add-embed" className="tooltip" />
            {embeds.map((_, index) => (
              <React.Fragment key={index}>
                <Tooltip id={`tooltip-embed-${index}`} className="tooltip" />
                <Tooltip id={`tooltip-delete-${index}`} className="tooltip" />
                <Tooltip id={`tooltip-field-name-${index}`} className="tooltip" />
                <Tooltip id={`tooltip-field-value-${index}`} className="tooltip" />
                <Tooltip id={`tooltip-field-inline-${index}`} className="tooltip" />
                <Tooltip id={`tooltip-remove-field-${index}`} className="tooltip" />
              </React.Fragment>
            ))}
            <Tooltip id="tooltip-import-json" className="tooltip" />
            <Tooltip id="tooltip-export-json" className="tooltip" />
            <Tooltip id="tooltip-toggle-sidebar" className="tooltip" />
            <Tooltip id="tooltip-builder-tab" className="tooltip" />
            <Tooltip id="tooltip-ai-tab" className="tooltip" />
            <Tooltip id="tooltip-title" className="tooltip" />
            <Tooltip id="tooltip-description" className="tooltip" />
            <Tooltip id="tooltip-color" className="tooltip" />
            <Tooltip id="tooltip-author" className="tooltip" />
            <Tooltip id="tooltip-footer" className="tooltip" />
            <Tooltip id="tooltip-image" className="tooltip" />
            <Tooltip id="tooltip-thumbnail" className="tooltip" />
            <Tooltip id="tooltip-timestamp" className="tooltip" />
            <Tooltip id="tooltip-add-field" className="tooltip" />
            <Tooltip id="tooltip-webhook" className="tooltip" />
            <Tooltip id="tooltip-send-webhook" className="tooltip" />
            <Tooltip id="tooltip-ai-prompt" className="tooltip" />
            <Tooltip id="tooltip-generate-ai" className="tooltip" />
            <Tooltip id="tooltip-json-input" className="tooltip" />
            <Tooltip id="tooltip-import-button" className="tooltip" />
            <Tooltip id="tooltip-cancel-button" className="tooltip" />
          </MotionComponent>
        );
      };

      ReactDOM.render(<PotatoEmbedGenerator />, document.getElementById('root'));
    } catch (error) {
      console.error('Initialization error:', error);
      document.getElementById('root').innerHTML = '<div class="error-message">Failed to load Potato Embed Generator. Please check your network connection or try again later.</div>';
    }
  </script>
</body>
</html>